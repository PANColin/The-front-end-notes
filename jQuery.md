# jQuery

### 为什么要学 jQuery

因为原生 js 在进行 DOM 操作时代码量多而且容错性差，不够简练。那么 jQuery 就是为了解决这些问题而出现的。

### jQuery 是什么

jQuery 是一个快速、简洁的 JavaScript 框架。jQuery 设计的宗旨是“write Less，Do More”，即倡导写更少的代码，做更多的事情。它封装 JavaScript 常用的功能代码，提供一种简便的 JavaScript 设计模式，优化 HTML 文档操作、事件处理、动画设计和 Ajax 交互。

在此阶段，我们主要介绍如何来使用 jQuery 操作 DOM，其实就是学习 jQuery 封装好的那些功能方法，这些方法叫做 API（Application Programming Interface 应用程序编程接口）。

### jQuery的引入

#### 引入方式

1. 下载到本地

   - 获取源文件
   - 引入页面，同时注意引用顺序，引入之后才能使用
   - <script src="./jquery-3.3.1.min.js" />

2. CDN引入

   - 找到可靠的CDN提供商，如：https://www.bootcdn.cn/

   - 复制CDN地址，粘贴到页面中

   - <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>



> jquery.js 和 jquery.min.js 的区别：
>
> jquery.js是完整的未压缩的jQuery库，文件比较大，一般用于阅读学习源码或修改源码，一般不用于线上项目。
>
> jquery.min.js是由完整版的jQuery库经过压缩得来，压缩后功能与未压缩的完全一样，只是将其中的空白字符、注释、空行等与逻辑无关的内容删除，并进行一些优化。这个版本一般用于网站引用使用，减小文件体积，降低网站流量，提升访问速度等。



### 版本选择

jQ 大体分为三个版本：1.xx 、 2.xx 、 3.xx，三个版本对比如下：

| 版本号    | 说明                             |
| :-------- | :------------------------------- |
| 1.xx 版本 | 兼容 IE678；不再更新；插件多；   |
| 2.xx 版本 | 不兼容 IE678；不再更新；插件少； |
| 3.xx 版本 | 不兼容 IE678；仍在更新；插件少； |

1.xx 版本优点在于支持 IE678，可以做浏览器兼容，插件是最丰富的的。1.7 之前的 1.x.x 版本与现在的高版本API相差较大，且选择器等各方面性能不高，因此推荐使用选用 1.7 之后的 1.x.x 版本。

2.x.x 版本相较于第一版没有增加什么新特性，主要是去除了对 IE678 的支持，提升了性能，减小了体积。

3.x.x 版本相较于之前版本，增加、删除、更改一些属性。

可以通过 *$.fn.jquery* 来查看 jQ 版本

# jQuery选择器

### $、jQuery

jQ 提供了两个变量 *$* 和 *jQuery* 给开发者使用，一般情况下使用 *$* 变量即可；如果遇见其它库提供了 *$* 变量，未防止冲突，可以使用 *jQuery* 变量。

#### 用法

```
$(selector/fn)
```

#### 参数

- *selector*：选择内容
- *fn*：函数

#### 入口函数

以函数作为参数时，作用相当于页面的入口函数，当页面内容加载完成后执行接受的函数。

与 `window.onload` 的区别：

- 执行时间
  - `window.onload` 必须等到页面内包括图片的所有元素加载完毕后才能执行。
  - `$(function(){}` 是 DOM 结构绘制完毕后就执行，不必等到加载完毕。因此执行时间比上面的快。
- 编写个数
  - `window.onload` 只能设定一个
  - jQ 入口函数可以同时编写多个，并且都可以得到执行。



### jQuery 的基本选择器

| 符号                          | 说明                                                  |
| :---------------------------- | :---------------------------------------------------- |
| $(‘#demo’)                    | 选择 id 为 demo 的元素                                |
| $(‘.demo’)                    | 选择 class 为 demo 的所有元素                         |
| $(‘div’)                      | 选择所有 div 标签元素                                 |
| $(‘*‘)                        | 选择所有标签元素                                      |
| $(‘.arr.arr-left’)            | 选择同时具有 arr 和 arr-left 类名的元素（交集选择器） |
| $('.arr .box,.arr .box-left') | 并集选择器                                            |

### jQuery 的其他选择器

#### 层级选择器

| 符号 | 说明                             |
| :--- | :------------------------------- |
| 空格 | 后代选择器                       |
| >    | 子代选择器**（直接后代选择器）** |
| +    | 紧邻兄弟选择器                   |
| ~    | 通用兄弟选择器                   |

#### 属性选择器

| 符号                            | 说明                                                        |
| :------------------------------ | :---------------------------------------------------------- |
| $(‘a[href]’)                    | 具有 href 属性的 a 标签                                     |
| $(‘a[href=’baidu’]’)            | href 属性为’baidu’的 a 标签                                 |
| $(‘a[href!=’baidu’]’)           | href 属性不为’baidu’的 a 标签,包括不具有 href 属性的 a 标签 |
| $(‘a[href^=’www’]’)             | href 属性以’www’开头的 a 标签                               |
| $(‘a[href$=’cn’]’)              | href 属性以’cn’结尾的 a 标签                                |
| $(‘a[href*=’i’]’)               | href 属性包含’i’的 a 标签                                   |
| $(‘a[href] [title = '内容'] ]’) | 具有 href 属性且 title 属性为’内容’的 a 标签                |

#### 基本筛选选择器

| 符号       | 说明(index 从 0 开始)        |
| :--------- | :--------------------------- |
| :eq(index) | 匹配一个给定索引值的元素     |
| :gt(index) | 匹配所有大于给定索引值的元素 |
| :lt(index) | 匹配所有小于给定索引值的元素 |
| :odd       | 匹配所有索引值为奇数的元素   |
| :even      | 匹配所有索引值为偶数的元素   |
| :first     | 获取匹配的第一个元素         |
| :last      | 获取匹配的最后一个元素       |

#### 其他选择器

| 符号            | 说明(index 从 0 开始)                | 用法                     |
| :-------------- | :----------------------------------- | :----------------------- |
| :empty          | 匹配所有不包含子元素或者文本的空元素 | $(‘li:empty’)            |
| :contains(text) | 匹配包含给定文本的元素               | $(‘li:contains(‘john’)’) |

 选择不到返回 []

### jQuery对象 和 DOM对象

**$(**selector|DOM|jQuery)  返回jQ对象。jQ对象是由符合选择条件的DOM对象组成的**伪数组**(不能使用数组的方法，但是有下标）⭐**
      **jQ对象 => DOM  根据下标选择到即可 $ele.get(index) ==> $ele[index]**
      **DOM => $DOM  $(DOM)**
使用 $(xxx) 相当于调用函数返回 jQ对象，因此每次返回结果是不重复的，尽管它们的内容一样。所以如果对同一个DOM对象的jQ形式有多个操作，尽量先声明变量获取jQ形式。**
变量最好使用 $ 前缀标识，例如：$box

### jQuery对象操作

#### 筛选关系节点

| 属性      | 说明                                      |
| :-------- | :---------------------------------------- |
| eq(index) | 获取当前 jQ 数组中下标为 index 的 jQ 对象 |
| find      | 返回符合条件的 jQ 对象的子节点            |
| parent    | 返回 jQ 对象的父节点                      |
| children  | 返回 jQ 对象的所有子节点                  |
| prev      | 返回 jQ 对象上一个兄弟节点                |
| prevAll   | 返回 jQ 对象的前面所有的兄弟节点          |
| next      | 返回 jQ 对象下一个兄弟节点                |
| nextAll   | 返回 jQ 对象后面所有的兄弟节点            |
| siblings  | 返回当前 jQ 对象所有的兄弟节点            |

上述所有方法皆可在括号中传入 selector

还有 `prevUntil`、`not`、`slice`…等等方法，更多请自行查阅 jQ 文档。

#### 样式操作

```txt
$ele.css("样式名") 获取元素的样式
$ele.css("样式名", "样式值")  设置单个元素样式
$ele.css({  一次设置多个元素的样式
    "样式名": "样式值",
    "样式名": "样式值",
    "样式名": "样式值"  
})
```

提示：当设置带单位的值时，可以省略单位。

#### 属性操作

```
$ele.attr("属性名") 获取属性值
$ele.attr("属性名", "属性值") 设置单个属性
$ele.attr({ 设置多个属性值
    "属性名": "属性值",
    "属性名": "属性值",
    "属性名": "属性值",
    "属性名": "属性值"
})

$ele.removeAttr("属性名")  删除属性

attr 可以更换为 prop
```

区别：

- *attr* 设置的**非官方定义属性**会出现在元素标签上，*prop* 设置的**非官方定义属性**会出现在元素对象上
- *attr* 获取表单选择属性返回设置的值，*prop* 获取表单选择属性返回 *boolean* 值

**注意**：attr、prop设置的自定义属性不能通过对方获取

#### 类名操作

$ele.addClass() 向被选元素添加一个或多个类
$ele.removeClass()  从被选元素删除一个或多个类
$ele.hasClass()  判断被选元素是否存在类
$ele.toggleClass()  对被选元素进行添加/删除类的切换操作

### 常见的元素操作

#### 添加元素

| 方法        | 作用                                   |
| :---------- | :------------------------------------- |
| before      | 在 jQ 对象之前插入内容                 |
| prepend     | 在 jQ 对象的第一个子节点之前插入内容   |
| append      | 在 jQ 对象的最后一个子节点之后插入内容 |
| after       | 在 jQ 对象之后插入内容                 |
| replaceWith | 使用内容替换该 jQ 对象                 |

方法参数：DOM节点、字符串、jQ对象

**注意**：如果被插入内容是某个已经拥有父节点的节点，在被传递给此方法后，它首先会被移除，再被插入到新的位置。

还有 `appendTo`、`prependTo`…等等方法，更多请自行查阅 jQ 文档。

#### 克隆节点

方法：`$ele.clone(是否克隆jQ添加的事件)`

#### 删除节点

方法：`$ele.remove()`

### 元素内容操作

| 方法         | 说明                           |
| :----------- | :----------------------------- |
| $ele.html()  | 获取或设置元素内容HTML字符串   |
| $ele.text()  | 获取或设置元素内容文本字符串   |
| $input.val() | 获取或设置input输入框的value值 |

## jQuery事件

在 jQ 中，事件绑定通过两种方式：

1. jQ对象.事件名(参数)
2. jQ对象.on(事件名，其它参数)

在 jQuery 1.7 之后，统一使用 `on` 方法提供绑定事件处理程序所需的所有功能。旧的 jQuery 事件绑定方法如 [.bind()](https://api.jquery.com/bind/), [.delegate()](https://api.jquery.com/delegate/), 和 [.live()](https://api.jquery.com/live/) 等不再推荐使用。

常见的事件如：`click`、`dblclick`、`keydown`、`mouseover`、`change`等都可以使用第一种方式绑定事件，但也有特殊的如输入框的 `input` 事件等不支持第一种方式。具体的支持事件列表请参见 jQuery 官方文档。

#### 事件对象

j**Q 事件中的事件对象**通过事件处理函数的**形参**获取，**事件中的 *event* 是 *window* 上的属性**，与原生事件中的事件对象一致。

jQ 事件对象常用属性也与之前学过的 DOM 事件对象几乎一致，多了一个 *data* 属性用于获取事件绑定时传入的参数。

#### 事件中的 this

jQ 事件中的 *this* 指向绑定事件的 jQ 对象代表的 DOM 对象，如果使用 *on* 方式添加的事件委托，委托事件处理函数中的 *this* 指向委托元素的 DOM 对象。

#### 事件特点

jQuery 允许给同一个 jQ 对象的同一个事件绑定多个不同的事件处理函数

### 直接绑定事件

语法

```
$ele.事件名([data], [fn])
```

#### 参数

- *data*：供函数使用的参数对象
- *fn*：事件处理函数

### on 方式绑定事件

#### 语法

```js
$ele.on(type, [selector], [data], fn)
```

#### 参数

- *type*：事件名，可以是一个或者多个。
- *selector*：一个选择器字符串，委托事件的元素选择器，可选。
- *data*：事件参数，可选。
- *fn*：该事件被触发时执行的函数。

### off 解绑事件

jQ 使用 `$ele.off()` 方法移除给当前对象绑定的事件处理函数

## jQuery特性

1. 链式操作: 原理 -- 调用jQ方法之后会返回调用该方法的jQ对象，因此可以无限使用该对象的方法
      如果是获取关系节点，那么会返回获取到的关系节点
      可以通过 .end() 方法返回jQ对象转移前的对象

2. 隐式迭代: 对jQ对象的每一个操作会对它获取的DOM数组的每一项执行该操作

```js
// 隐式迭代
        $("li").css("color", "#f00")
            .css("font-size", "30px")
            .addClass("d6");

//链式操作（原理）
        var obj = {
            a: function(){
                console.log("a");
                return this;
            },
            b: function(){
                console.log("b");
                return this;
            }
        }

        obj.a().b().a().b().a().a();
```

